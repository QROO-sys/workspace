exports.id=106,exports.ids=[106],exports.modules={9888:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},3366:(e,t,s)=>{Promise.resolve().then(s.bind(s,6579))},7173:(e,t,s)=>{Promise.resolve().then(s.bind(s,4626))},6579:(e,t,s)=>{"use strict";s.d(t,{default:()=>m});var a=s(326),n=s(434),r=s(5047),l=s(7577);let i={owner:"Admin",dashboard:"Dashboard",sessions:"Sessions",bookings:"Bookings",menu:"Menu",desks:"Desks",analytics:"Analytics",users:"Users",requests:"Requests",login:"Login",register:"Register",checkout:"Checkout"};function o(){let e=(0,r.usePathname)().split("/").filter(Boolean);if(e.length<=1)return null;let t="";return a.jsx("nav",{className:"text-sm text-gray-600","aria-label":"Breadcrumb",children:(0,a.jsxs)("ol",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("li",{children:a.jsx(n.default,{className:"hover:underline",href:"/",children:"Home"})}),e.map((s,r)=>{t+=`/${s}`;let l=r===e.length-1,o=i[s]||s;return(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-gray-400",children:"/"}),l?a.jsx("span",{className:"text-gray-900",children:o}):a.jsx(n.default,{className:"hover:underline",href:t,children:o})]},`${t}`)})]})})}var d=s(8069),u=s(6244);function m({initialLang:e}){(0,r.usePathname)();let t=(0,r.useRouter)(),[s,i]=(0,l.useState)(!1),[m,c]=(0,l.useState)((0,u.AE)(e));async function h(e){c(e);try{await fetch("/api/lang",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lang:e})})}finally{t.refresh()}}async function x(){try{await (0,d.S)("/auth/logout",{method:"POST"})}catch{}t.push("/login"),t.refresh()}return a.jsx("header",{className:"border-b bg-white",children:(0,a.jsxs)("div",{className:"mx-auto flex max-w-5xl items-center justify-between gap-4 px-4 py-3",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[a.jsx(n.default,{href:"/",className:"text-lg font-semibold",children:"QROO Workspace"}),a.jsx(o,{})]}),(0,a.jsxs)("nav",{className:"flex items-center gap-3 text-sm",children:[(0,a.jsxs)("select",{className:"rounded border bg-white px-2 py-1",value:m,onChange:e=>h((0,u.AE)(e.target.value)),"aria-label":(0,u.t)(m,"langSwitch"),children:[a.jsx("option",{value:"en",children:(0,u.t)("en","langName")}),a.jsx("option",{value:"ar-eg",children:(0,u.t)("ar-eg","langName")})]}),a.jsx(n.default,{className:"hover:underline",href:"/register",children:"Register"}),a.jsx(n.default,{className:"hover:underline",href:"/login",children:(0,u.t)(m,"login")}),a.jsx(n.default,{className:"hover:underline",href:"/owner/dashboard",children:"Admin"}),s?a.jsx("button",{className:"rounded border px-3 py-1 hover:bg-gray-50",onClick:x,children:(0,u.t)(m,"logout")}):null]})]})})}},4626:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(326),n=s(7577),r=s(5047);function l({date:e,occupied:t,durationHours:s,selected:n,onSelect:r,startHour:l=7,endHour:i=23}){let o=[];for(let a=l;a<=i;a++){let n=new Date(e);n.setHours(a,0,0,0);let r=new Date(n);r.setHours(r.getHours()+Math.max(1,s));let l=!t.some(e=>{let t=new Date(e.startAt);return n<new Date(e.endAt?e.endAt:new Date(e.startAt).getTime()+36e5)&&r>t});o.push({time:n,available:l})}return a.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-4",children:o.map(e=>{let t=!!n&&e.time.getTime()===n.getTime(),s=e.time.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),l="rounded border px-3 py-2 text-sm",i=e.available?t?`${l} bg-green-600 text-white border-green-700`:`${l} bg-green-50 border-green-200 hover:bg-green-100`:`${l} bg-red-50 border-red-200 text-gray-400 cursor-not-allowed`;return a.jsx("button",{type:"button",className:i,onClick:()=>e.available&&r(e.time),disabled:!e.available,title:e.available?"Available":"Unavailable",children:s},e.time.toISOString())})})}var i=s(8069);function o(e){return new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(e)+" EGP"}function d({desk:e,menuItems:t,upcoming:s,defaultMode:d="NOW"}){let u=(0,r.useRouter)(),[m,c]=(0,n.useState)(d),[h,x]=(0,n.useState)(()=>new Date().toISOString().slice(0,10)),[g,p]=(0,n.useState)([]),[b,v]=(0,n.useState)(""),[f,y]=(0,n.useState)(null),[N,S]=(0,n.useState)(1),[j,w]=(0,n.useState)(0),[k,R]=(0,n.useState)({}),[T,A]=(0,n.useState)(""),[D,P]=(0,n.useState)(""),[O,L]=(0,n.useState)(null),[C,M]=(0,n.useState)(""),[E,I]=(0,n.useState)(!1),[B,_]=(0,n.useState)(!1),[U,q]=(0,n.useState)(null),H=(0,n.useMemo)(()=>t.find(e=>{let t=(e.sku||"").toUpperCase(),s=(e.name||"").toLowerCase();return"HOUR"===t||"001"===t||"extra hour"===s}),[t]),$=(0,n.useMemo)(()=>t.find(e=>{let t=(e.sku||"").toUpperCase(),s=(e.name||"").toLowerCase();return"COFFEE"===t||"002"===t||"coffee"===s}),[t]),F=(0,n.useMemo)(()=>{let e=new Set([H?.id,$?.id].filter(Boolean));return t.filter(t=>!e.has(t.id))},[t,H?.id,$?.id]),W=(0,n.useMemo)(()=>{let t=Number(e?.hourlyRate||0)*Math.max(1,Number(N||1));for(let e of($&&(t+=Number($.price||0)*Math.max(0,Number(j||0))),F)){let s=Math.max(0,Number(k[e.id]||0));t+=Number(e.price||0)*s}return t},[e?.hourlyRate,N,$,j,F,k]),Q=b?new Date(b):null,G=(0,n.useMemo)(()=>new Date(`${h}T00:00:00`),[h]);async function J(){if(!O)return"";if(C)return C;I(!0);try{let e=new FormData;e.append("file",O);let t=process.env.NEXT_PUBLIC_API_URL||"http://localhost:3001",s=await fetch(`${t}/public/uploads/national-id`,{method:"POST",body:e});if(!s.ok)throw Error("Upload failed");let a=await s.json(),n=a?.path||"";return M(n),n}finally{I(!1)}}async function X(){let t;if(q(null),!H){q("Missing 'Extra hour' menu item (sku HOUR). Add it in Admin → Menu.");return}if(!T.trim()||!D.trim()){q("Name and phone are required.");return}if("LATER"===m){if(!b){q("Pick a start time first.");return}t=new Date(b).toISOString()}let s=[];for(let e of(s.push({menuItemId:H.id,quantity:Math.max(1,Number(N||1))}),$&&j>0&&s.push({menuItemId:$.id,quantity:Math.max(0,Number(j||0))}),F)){let t=Math.max(0,Number(k[e.id]||0));t>0&&s.push({menuItemId:e.id,quantity:t})}_(!0);try{let a=await J(),n=await (0,i.S)("/orders/guest",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tableId:e.id,items:s,startAt:t,customerName:T.trim(),customerPhone:D.trim(),customerNationalIdPath:a||void 0})});u.push(`/checkout?orderId=${encodeURIComponent(n.id)}`)}catch(e){q(e?.message||"Failed to place order")}finally{_(!1)}}async function Y(t){q(null);try{await (0,i.S)(`/public/tables/${e.id}/requests`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({requestType:t,customerName:T.trim()||void 0,customerPhone:D.trim()||void 0})})}catch(e){q(e?.message||"Failed to send request")}}return(0,a.jsxs)("div",{className:"mx-auto max-w-2xl px-6 py-8",children:[a.jsx("h1",{className:"text-2xl font-bold",children:e.name}),a.jsx("p",{className:"text-sm text-gray-600",children:"Use this QR page to extend time, order items, or book later."}),s?.length?(0,a.jsxs)("div",{className:"mt-4 rounded border bg-white p-4",children:[a.jsx("div",{className:"text-sm font-semibold",children:"Upcoming bookings"}),a.jsx("ul",{className:"mt-2 space-y-1 text-sm text-gray-700",children:s.slice(0,5).map(e=>(0,a.jsxs)("li",{children:[new Date(e.startAt).toLocaleString()," → ",new Date(e.endAt).toLocaleString()]},e.id))})]}):null,U?a.jsx("div",{className:"mt-4 rounded border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:U}):null,(0,a.jsxs)("div",{className:"mt-4 rounded border bg-white p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("label",{className:"text-sm font-medium",children:"Session"}),(0,a.jsxs)("select",{className:"rounded border px-3 py-2 text-sm",value:m,onChange:e=>{let t=e.target.value;c(t),"NOW"===t&&v("")},children:[a.jsx("option",{value:"NOW",children:"Start now"}),a.jsx("option",{value:"LATER",children:"Book later"})]})]}),"LATER"===m?(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-end justify-between gap-3",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Pick a day"}),a.jsx("input",{className:"mt-1 w-full rounded border px-3 py-2",type:"date",value:h,onChange:e=>{x(e.target.value),v("")}})]}),a.jsx("div",{className:"text-xs text-gray-600",children:"Green = available, red = unavailable"})]}),f?a.jsx("div",{className:"mt-2 rounded border border-red-200 bg-red-50 p-2 text-sm text-red-700",children:f}):null,a.jsx("div",{className:"mt-3",children:a.jsx(l,{date:G,occupied:g,durationHours:Math.max(1,Number(N||1)),selected:Q,onSelect:e=>v(e.toISOString())})})]}):null,(0,a.jsxs)("div",{className:"mt-4 grid gap-3 sm:grid-cols-2",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Hours"}),a.jsx("input",{className:"mt-1 w-full rounded border px-3 py-2",type:"number",min:1,value:N,onChange:e=>S(Number(e.target.value||1))}),(0,a.jsxs)("div",{className:"mt-1 text-xs text-gray-600",children:["Rate: ",o(Number(e.hourlyRate||0)),"/hour"]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Coffee"}),a.jsx("input",{className:"mt-1 w-full rounded border px-3 py-2",type:"number",min:0,value:j,onChange:e=>w(Number(e.target.value||0))}),a.jsx("div",{className:"mt-1 text-xs text-gray-600",children:$?`Coffee: ${o(Number($.price||0))}`:"Coffee item not set"})]})]}),F.length?(0,a.jsxs)("div",{className:"mt-4",children:[a.jsx("div",{className:"text-sm font-medium",children:"Other items"}),a.jsx("div",{className:"mt-2 grid gap-3 sm:grid-cols-2",children:F.map(e=>a.jsx("div",{className:"rounded border p-3",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-medium",children:e.name}),a.jsx("div",{className:"text-xs text-gray-600",children:o(Number(e.price||0))})]}),a.jsx("input",{className:"w-20 rounded border px-2 py-1",type:"number",min:0,value:k[e.id]||0,onChange:t=>R(s=>({...s,[e.id]:Number(t.target.value||0)}))})]})},e.id))})]}):null,(0,a.jsxs)("div",{className:"mt-4 grid gap-3 sm:grid-cols-2",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Your name"}),a.jsx("input",{className:"mt-1 w-full rounded border px-3 py-2",value:T,onChange:e=>A(e.target.value)})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Phone"}),a.jsx("input",{className:"mt-1 w-full rounded border px-3 py-2",value:D,onChange:e=>P(e.target.value)})]})]}),e?.laptopSerial?(0,a.jsxs)("div",{className:"mt-4 rounded border bg-gray-50 p-3",children:[a.jsx("div",{className:"text-sm font-medium",children:"Laptop use"}),(0,a.jsxs)("div",{className:"mt-1 text-xs text-gray-600",children:["This desk has a laptop assigned (",e.laptopSerial,"). You can upload a National ID photo for verification."]}),a.jsx("input",{className:"mt-2 w-full",type:"file",accept:"image/*,application/pdf",onChange:e=>L(e.target.files?.[0]||null)}),E?a.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Uploading…"}):null,C?(0,a.jsxs)("div",{className:"mt-2 text-xs text-gray-600",children:["Uploaded: ",C]}):null]}):null,(0,a.jsxs)("div",{className:"mt-4 rounded border bg-gray-50 p-3",children:[a.jsx("div",{className:"text-sm font-medium",children:"Quick requests (alerts admin)"}),(0,a.jsxs)("div",{className:"mt-2 flex flex-wrap gap-2",children:[a.jsx("button",{type:"button",className:"rounded border px-3 py-1 text-sm",onClick:()=>Y("CALL_STAFF"),children:"Call staff"}),a.jsx("button",{type:"button",className:"rounded border px-3 py-1 text-sm",onClick:()=>Y("WATER"),children:"Water"}),a.jsx("button",{type:"button",className:"rounded border px-3 py-1 text-sm",onClick:()=>Y("BILL"),children:"Bill"})]})]}),(0,a.jsxs)("div",{className:"mt-4 flex items-center justify-between gap-3",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Total"}),a.jsx("div",{className:"text-xl font-bold",children:o(W)})]}),a.jsx("button",{className:"rounded bg-gray-900 px-4 py-2 text-sm text-white disabled:opacity-60",disabled:B||E,onClick:X,type:"button",children:B?"Submitting…":"Proceed to checkout"})]})]}),a.jsx("div",{className:"mt-6 text-xs text-gray-600",children:"Tip: Admin can see live alerts in Admin → Requests. SMS alerts require SMS_PROVIDER and SMS_ADMIN_TO in the backend .env."})]})}},8069:(e,t,s)=>{"use strict";async function a(e,t){let s=process.env.NEXT_PUBLIC_API_URL||"http://localhost:3001",a=await fetch(`${s}${e}`,{...t,credentials:"include"});if(!a.ok)throw Error(await a.text()||`Request failed: ${a.status}`);return(a.headers.get("content-type")||"").includes("application/json")?a.json():a.text()}s.d(t,{S:()=>a})},6244:(e,t,s)=>{"use strict";function a(e){let t=(e||"").toLowerCase().trim();return"ar"===t||"ar-eg"===t||"ar_eg"===t||"ar-egypt"===t?"ar-eg":"en"}s.d(t,{AE:()=>a,t:()=>r});let n={en:{langName:"English",langSwitch:"Language",login:"Login",email:"Email",password:"Password",signIn:"Sign in",logout:"Log out",dashboard:"Dashboard",analytics:"Analytics",dailyRevenue:"Daily revenue",totalRevenueAllTime:"Total revenue (all time)",todayRevenue:"Today's revenue",openBookings:"Open bookings",openOrders:"Open orders",requests:"Requests",bookings:"Bookings",desks:"Desks",menuItems:"Menu items",users:"Users",dbTools:"DB tools",smsTools:"SMS",save:"Save",setAllHourlyRates:"Set hourly rate for ALL desks",hourlyRate:"Hourly rate",runDbPush:"Push schema to DB",runDbReset:"Reset DB (danger)",runSeed:"Seed demo data",enableDbToolsHint:"Set ENABLE_DB_TOOLS=true in backend .env to enable these buttons.",sendTestSms:"Send test SMS",adminPhone:"Admin phone",message:"Message"},"ar-eg":{langName:"عربي (مصر)",langSwitch:"اللغة",login:"تسجيل الدخول",email:"الإيميل",password:"كلمة السر",signIn:"دخول",logout:"تسجيل خروج",dashboard:"لوحة التحكم",analytics:"الإحصائيات",dailyRevenue:"إيراد يومي",totalRevenueAllTime:"إجمالي الإيراد (من البداية)",todayRevenue:"إيراد النهارده",openBookings:"حجوزات مفتوحة",openOrders:"طلبات مفتوحة",requests:"الطلبات",bookings:"الحجوزات",desks:"المكاتب",menuItems:"المنتجات",users:"المستخدمين",dbTools:"أدوات قاعدة البيانات",smsTools:"رسائل SMS",save:"حفظ",setAllHourlyRates:"تعيين سعر الساعة لكل المكاتب",hourlyRate:"سعر الساعة",runDbPush:"تطبيق الـ Schema على قاعدة البيانات",runDbReset:"مسح وإعادة تهيئة الداتا (خطر)",runSeed:"تحميل داتا تجريبية",enableDbToolsHint:"فعّل ENABLE_DB_TOOLS=true في ملف backend .env علشان الأزرار تشتغل.",sendTestSms:"إرسال SMS تجريبي",adminPhone:"موبايل الأدمن",message:"الرسالة"}};function r(e,t){return n[e]?.[t]??n.en[t]??t}},5079:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o,metadata:()=>i});var a=s(9510);s(5023);let n=(0,s(8570).createProxy)(String.raw`/Users/fuuentes/workspace/qroo_final/workspace/frontend/src/components/AppHeader.tsx#default`);var r=s(1615),l=s(2984);let i={title:"QROO Workspace"};function o({children:e}){let t=(0,l.AE)(r.cookies().get("lang")?.value),s=(0,l.Wt)(t);return a.jsx("html",{lang:"ar-eg"===t?"ar-EG":"en",dir:s,children:(0,a.jsxs)("body",{className:"bg-gray-50 min-h-screen text-gray-900",children:[a.jsx(n,{initialLang:t}),a.jsx("main",{className:"mx-auto max-w-5xl p-4",children:e})]})})}},153:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(8570).createProxy)(String.raw`/Users/fuuentes/workspace/qroo_final/workspace/frontend/src/components/DeskCheckinClient.tsx#default`)},2984:(e,t,s)=>{"use strict";function a(e){let t=(e||"").toLowerCase().trim();return"ar"===t||"ar-eg"===t||"ar_eg"===t||"ar-egypt"===t?"ar-eg":"en"}function n(e){return"ar-eg"===e?"rtl":"ltr"}s.d(t,{AE:()=>a,Wt:()=>n,t:()=>l});let r={en:{langName:"English",langSwitch:"Language",login:"Login",email:"Email",password:"Password",signIn:"Sign in",logout:"Log out",dashboard:"Dashboard",analytics:"Analytics",dailyRevenue:"Daily revenue",totalRevenueAllTime:"Total revenue (all time)",todayRevenue:"Today's revenue",openBookings:"Open bookings",openOrders:"Open orders",requests:"Requests",bookings:"Bookings",desks:"Desks",menuItems:"Menu items",users:"Users",dbTools:"DB tools",smsTools:"SMS",save:"Save",setAllHourlyRates:"Set hourly rate for ALL desks",hourlyRate:"Hourly rate",runDbPush:"Push schema to DB",runDbReset:"Reset DB (danger)",runSeed:"Seed demo data",enableDbToolsHint:"Set ENABLE_DB_TOOLS=true in backend .env to enable these buttons.",sendTestSms:"Send test SMS",adminPhone:"Admin phone",message:"Message"},"ar-eg":{langName:"عربي (مصر)",langSwitch:"اللغة",login:"تسجيل الدخول",email:"الإيميل",password:"كلمة السر",signIn:"دخول",logout:"تسجيل خروج",dashboard:"لوحة التحكم",analytics:"الإحصائيات",dailyRevenue:"إيراد يومي",totalRevenueAllTime:"إجمالي الإيراد (من البداية)",todayRevenue:"إيراد النهارده",openBookings:"حجوزات مفتوحة",openOrders:"طلبات مفتوحة",requests:"الطلبات",bookings:"الحجوزات",desks:"المكاتب",menuItems:"المنتجات",users:"المستخدمين",dbTools:"أدوات قاعدة البيانات",smsTools:"رسائل SMS",save:"حفظ",setAllHourlyRates:"تعيين سعر الساعة لكل المكاتب",hourlyRate:"سعر الساعة",runDbPush:"تطبيق الـ Schema على قاعدة البيانات",runDbReset:"مسح وإعادة تهيئة الداتا (خطر)",runSeed:"تحميل داتا تجريبية",enableDbToolsHint:"فعّل ENABLE_DB_TOOLS=true في ملف backend .env علشان الأزرار تشتغل.",sendTestSms:"إرسال SMS تجريبي",adminPhone:"موبايل الأدمن",message:"الرسالة"}};function l(e,t){return r[e]?.[t]??r.en[t]??t}},5023:()=>{}};
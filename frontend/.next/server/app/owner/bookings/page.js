(()=>{var e={};e.id=850,e.ids=[850],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6701:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),s(5903),s(446),s(5079),s(5866);var a=s(3191),r=s(8716),n=s(7922),o=s.n(n),l=s(5231),i={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>l[e]);s.d(t,i);let d=["",{children:["owner",{children:["bookings",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,5903)),"/Users/fuuentes/workspace/qroo_final/workspace/frontend/src/app/owner/bookings/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,446)),"/Users/fuuentes/workspace/qroo_final/workspace/frontend/src/app/owner/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,5079)),"/Users/fuuentes/workspace/qroo_final/workspace/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/fuuentes/workspace/qroo_final/workspace/frontend/src/app/owner/bookings/page.tsx"],u="/owner/bookings/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/owner/bookings/page",pathname:"/owner/bookings",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9210:(e,t,s)=>{Promise.resolve().then(s.bind(s,26))},26:(e,t,s)=>{"use strict";s.d(t,{default:()=>i});var a=s(326),r=s(7577),n=s(5047),o=s(8069);function l(e){let t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleString()}function i({desks:e,menuItems:t,upcoming:s}){let i=(0,n.useRouter)(),[d,c]=(0,r.useState)(e[0]?.id||""),[u,m]=(0,r.useState)(""),[x,p]=(0,r.useState)(""),[g,h]=(0,r.useState)(()=>(function(e){let t=e=>String(e).padStart(2,"0"),s=e.getFullYear(),a=t(e.getMonth()+1),r=t(e.getDate()),n=t(e.getHours()),o=t(e.getMinutes());return`${s}-${a}-${r}T${n}:${o}`})(new Date(Date.now()+36e5))),[b,f]=(0,r.useState)(1),[y,j]=(0,r.useState)(0),[v,N]=(0,r.useState)(0),[w,k]=(0,r.useState)(0),[S,I]=(0,r.useState)(!1),[C,P]=(0,r.useState)(null),_=(0,r.useMemo)(()=>{let e=new Map(t.map(e=>[e.sku,e.id]));return{extraHourId:e.get("001"),coffeeId:e.get("002"),teaId:e.get("003"),pastryId:e.get("004")}},[t]);async function q(){if(P(null),!d)return P("Pick a desk.");if(!_.extraHourId)return P("Missing menu item SKU 001 (Extra hour).");let e=new Date(g);if(Number.isNaN(e.getTime()))return P("Pick a valid start time.");if(!Number.isFinite(b)||b<=0)return P("Hours must be at least 1.");let t=[{menuItemId:_.extraHourId,quantity:Math.floor(b)}];y>0&&_.coffeeId&&t.push({menuItemId:_.coffeeId,quantity:Math.floor(y)}),v>0&&_.teaId&&t.push({menuItemId:_.teaId,quantity:Math.floor(v)}),w>0&&_.pastryId&&t.push({menuItemId:_.pastryId,quantity:Math.floor(w)}),I(!0);try{await (0,o.S)("/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tableId:d,customerName:u||void 0,customerPhone:x||void 0,startAt:e.toISOString(),items:t})}),m(""),p(""),f(1),j(0),N(0),k(0),i.refresh()}catch(e){P(e?.message||"Failed to create booking.")}finally{I(!1)}}async function M(e,t){P(null),I(!0);try{await (0,o.S)(`/orders/${e}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})}),i.refresh()}catch(e){P(e?.message||"Failed to update status.")}finally{I(!1)}}return(0,a.jsxs)("div",{className:"mt-6 grid gap-6 lg:grid-cols-2",children:[(0,a.jsxs)("div",{className:"rounded border bg-white p-4",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Create a booking"}),a.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"This reserves a desk for a future time slot. If the desk is already booked, you’ll get an error."}),C&&a.jsx("div",{className:"mt-3 rounded border border-red-200 bg-red-50 p-2 text-sm text-red-700",children:C}),(0,a.jsxs)("div",{className:"mt-4 grid gap-2",children:[a.jsx("label",{className:"text-xs text-gray-600",children:"Desk"}),a.jsx("select",{className:"rounded border p-2",value:d,onChange:e=>c(e.target.value),children:e.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name,e.laptopSerial?` (Laptop ${e.laptopSerial})`:""]},e.id))}),a.jsx("label",{className:"mt-2 text-xs text-gray-600",children:"Start time"}),a.jsx("input",{type:"datetime-local",className:"rounded border p-2",value:g,onChange:e=>h(e.target.value)}),(0,a.jsxs)("div",{className:"mt-2 grid gap-2 sm:grid-cols-2",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-xs text-gray-600",children:"Hours (SKU 001)"}),a.jsx("input",{type:"number",min:1,className:"w-full rounded border p-2",value:b,onChange:e=>f(parseInt(e.target.value||"1",10))})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-xs text-gray-600",children:"Coffee qty (SKU 002)"}),a.jsx("input",{type:"number",min:0,className:"w-full rounded border p-2",value:y,onChange:e=>j(parseInt(e.target.value||"0",10))}),a.jsx("div",{className:"mt-1 text-[11px] text-gray-500",children:"Free coffee will be applied automatically (1 per paid hour)."})]})]}),(0,a.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-xs text-gray-600",children:"Tea qty (SKU 003)"}),a.jsx("input",{type:"number",min:0,className:"w-full rounded border p-2",value:v,onChange:e=>N(parseInt(e.target.value||"0",10))})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-xs text-gray-600",children:"Pastry qty (SKU 004)"}),a.jsx("input",{type:"number",min:0,className:"w-full rounded border p-2",value:w,onChange:e=>k(parseInt(e.target.value||"0",10))})]})]}),a.jsx("label",{className:"mt-2 text-xs text-gray-600",children:"Customer name (optional)"}),a.jsx("input",{className:"rounded border p-2",value:u,onChange:e=>m(e.target.value)}),a.jsx("label",{className:"text-xs text-gray-600",children:"Phone (optional)"}),a.jsx("input",{className:"rounded border p-2",value:x,onChange:e=>p(e.target.value)})]}),a.jsx("button",{className:"mt-4 w-full rounded bg-blue-600 px-4 py-2 font-semibold text-white disabled:opacity-60",disabled:S,onClick:q,type:"button",children:S?"Saving...":"Create booking"})]}),(0,a.jsxs)("div",{className:"rounded border bg-white p-4",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Upcoming bookings"}),a.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Future start times (not cancelled / completed)."}),(0,a.jsxs)("div",{className:"mt-4 space-y-3",children:[(s||[]).map(e=>{var t;return(0,a.jsxs)("div",{className:"rounded border bg-white p-3",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"font-semibold",children:e.table?.name||"Desk"}),a.jsx("div",{className:"text-xs text-gray-600",children:e.startAt&&e.endAt?(0,a.jsxs)("span",{children:[l(e.startAt)," → ",l(e.endAt)]}):a.jsx("span",{children:new Date(e.createdAt).toLocaleString()})}),(e.customerName||e.customerPhone)&&(0,a.jsxs)("div",{className:"mt-1 text-sm text-gray-700",children:[e.customerName?a.jsx("span",{children:e.customerName}):null,e.customerPhone?a.jsx("span",{className:"ml-2 text-gray-500",children:e.customerPhone}):null]})]}),(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("div",{className:"text-lg font-bold",children:(t=e.total,new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(t)+" EGP")}),(0,a.jsxs)("div",{className:"text-xs text-gray-600",children:["Status: ",e.status]})]})]}),(0,a.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2",children:[a.jsx("button",{className:"rounded border px-3 py-1 text-sm disabled:opacity-60",disabled:S,onClick:()=>M(e.id,"CONFIRMED"),type:"button",children:"Confirm"}),a.jsx("button",{className:"rounded bg-green-600 px-3 py-1 text-sm text-white disabled:opacity-60",disabled:S,onClick:()=>M(e.id,"COMPLETED"),type:"button",children:"Completed"}),a.jsx("button",{className:"rounded bg-gray-700 px-3 py-1 text-sm text-white disabled:opacity-60",disabled:S,onClick:()=>M(e.id,"CANCELLED"),type:"button",children:"Cancel"})]})]},e.id)}),(!s||0===s.length)&&a.jsx("div",{className:"text-sm text-gray-600",children:"No upcoming bookings."})]})]})]})}},5903:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=s(9510);let r=(0,s(8570).createProxy)(String.raw`/Users/fuuentes/workspace/qroo_final/workspace/frontend/src/components/OwnerBookingsClient.tsx#default`);var n=s(2293);async function o(){let[e,t,s]=await Promise.all([(0,n.M)("/desks"),(0,n.M)("/menu-items"),(0,n.M)("/orders/upcoming")]);return(0,a.jsxs)("div",{className:"mx-auto max-w-5xl px-6 py-8",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Bookings"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Create and manage future desk time slots."})]}),a.jsx(r,{desks:e,menuItems:t,upcoming:s})]})}},2293:(e,t,s)=>{"use strict";s.d(t,{M:()=>r});var a=s(1615);async function r(e){let t=process.env.NEXT_PUBLIC_API_URL||"http://localhost:3001",s=(0,a.cookies)(),r=s.get("access_token")?.value,n=await fetch(`${t}${e}`,{cache:"no-store",headers:r?{cookie:`access_token=${r}`}:{}});if(!n.ok)throw Error(await n.text()||`Request failed: ${n.status}`);return n.json()}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[380,301,569],()=>s(6701));module.exports=a})();
(()=>{var e={};e.id=54,e.ids=[54],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5761:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>l}),r(8047),r(446),r(5079),r(5866);var s=r(3191),a=r(8716),n=r(7922),i=r.n(n),o=r(5231),d={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);r.d(t,d);let l=["",{children:["owner",{children:["menu",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,8047)),"/Users/fuuentes/workspace/qroo_final/workspace/frontend/src/app/owner/menu/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,446)),"/Users/fuuentes/workspace/qroo_final/workspace/frontend/src/app/owner/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,5079)),"/Users/fuuentes/workspace/qroo_final/workspace/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/fuuentes/workspace/qroo_final/workspace/frontend/src/app/owner/menu/page.tsx"],u="/owner/menu/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/owner/menu/page",pathname:"/owner/menu",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},8393:(e,t,r)=>{Promise.resolve().then(r.bind(r,1659))},1659:(e,t,r)=>{"use strict";r.d(t,{default:()=>o});var s=r(326),a=r(5047),n=r(7577),i=r(8069);function o({items:e,categories:t}){let r=(0,a.useRouter)(),[o,d]=(0,n.useState)(""),[l,c]=(0,n.useState)(""),[u,p]=(0,n.useState)(0),[m,x]=(0,n.useState)(""),[h,g]=(0,n.useState)(t[0]?.id||""),[f,b]=(0,n.useState)(null),[v,y]=(0,n.useState)(!1),[j,w]=(0,n.useState)(()=>Object.fromEntries(e.map(e=>[e.id,{name:e.name,price:String(e.price??0),description:e.description||""}]))),N=(0,n.useMemo)(()=>new Map(t.map(e=>[e.id,e])),[t]);async function S(e){if(e.preventDefault(),b(null),!o.trim()){b("SKU is required.");return}if(l.trim()){if(!h){b("Create a category first.");return}y(!0);try{await (0,i.S)("/menu-items",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sku:o,name:l,price:Number(u),description:m||void 0,categoryId:h})}),d(""),c(""),p(0),x(""),r.refresh()}catch(e){b(e?.message||"Failed to create")}finally{y(!1)}}}async function _(e){if(confirm("Delete this item?")){y(!0),b(null);try{await (0,i.S)(`/menu-items/${e}`,{method:"DELETE"}),r.refresh()}catch(e){b(e?.message||"Failed to delete")}finally{y(!1)}}}async function P(e){y(!0),b(null);try{let t=j[e],s=Number(t?.price||0);if(!t?.name?.trim())throw Error("Name is required");if(!Number.isFinite(s)||s<0)throw Error("Price must be a valid number");await (0,i.S)(`/menu-items/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t.name.trim(),price:s,description:t.description||null})}),r.refresh()}catch(e){b(e?.message||"Failed to update")}finally{y(!1)}}return(0,s.jsxs)("div",{className:"mt-6",children:[s.jsx("div",{className:"rounded border bg-white p-4",children:(0,s.jsxs)("div",{className:"text-sm text-gray-700",children:[s.jsx("b",{children:"Rule:"})," One coffee is free per paid hour. The backend applies the discount using SKUs: ",s.jsx("b",{children:"Extra hour = 001"})," and ",s.jsx("b",{children:"Coffee = 002"}),". (Names can change; the SKU rule stays stable.)"]})}),(0,s.jsxs)("form",{onSubmit:S,className:"mt-4 rounded border bg-white p-4",children:[(0,s.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2",children:[s.jsx("input",{className:"rounded border p-2",placeholder:"SKU (e.g., 001)",value:o,onChange:e=>d(e.target.value)}),s.jsx("input",{className:"rounded border p-2",placeholder:"Item name",value:l,onChange:e=>c(e.target.value)}),s.jsx("input",{className:"rounded border p-2",placeholder:"Price (EGP)",value:u,onChange:e=>p(Number(e.target.value)),type:"number",min:"0"}),s.jsx("select",{className:"rounded border p-2",value:h,onChange:e=>g(e.target.value),children:t.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))}),s.jsx("input",{className:"rounded border p-2",placeholder:"Description (optional)",value:m,onChange:e=>x(e.target.value)})]}),f&&s.jsx("div",{className:"mt-3 rounded border border-red-200 bg-red-50 p-2 text-sm text-red-700",children:f}),s.jsx("button",{className:"mt-3 rounded bg-blue-600 px-4 py-2 text-white disabled:opacity-60",disabled:v,type:"submit",children:"Add item"})]}),(0,s.jsxs)("div",{className:"mt-6 space-y-2",children:[e.map(e=>(0,s.jsxs)("div",{className:"rounded border bg-white p-3",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,s.jsxs)("div",{className:"font-medium",children:["[",e.sku,"]"]}),s.jsx("div",{className:"text-xs text-gray-600",children:N.get(e.categoryId)?.name||"Category"}),(0,s.jsxs)("div",{className:"ml-auto flex gap-2",children:[s.jsx("button",{className:"rounded border px-2 py-1 text-xs",disabled:v,onClick:()=>P(e.id),type:"button",children:"Save"}),s.jsx("button",{className:"rounded border px-2 py-1 text-xs",disabled:v,onClick:()=>_(e.id),type:"button",children:"Delete"})]})]}),(0,s.jsxs)("div",{className:"mt-2 grid gap-2 sm:grid-cols-3",children:[s.jsx("input",{className:"rounded border p-2 text-sm",value:j[e.id]?.name??e.name,onChange:t=>w(r=>({...r,[e.id]:{...r[e.id]||{name:e.name,price:String(e.price),description:e.description||""},name:t.target.value}}))}),s.jsx("input",{className:"rounded border p-2 text-sm",type:"number",min:"0",value:j[e.id]?.price??String(e.price),onChange:t=>w(r=>({...r,[e.id]:{...r[e.id]||{name:e.name,price:String(e.price),description:e.description||""},price:t.target.value}}))}),s.jsx("input",{className:"rounded border p-2 text-sm",placeholder:"Description",value:j[e.id]?.description??(e.description||""),onChange:t=>w(r=>({...r,[e.id]:{...r[e.id]||{name:e.name,price:String(e.price),description:e.description||""},description:t.target.value}}))})]})]},e.id)),0===e.length&&s.jsx("div",{className:"text-sm text-gray-600",children:"No menu items yet."})]})]})}},8047:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(9510);let a=(0,r(8570).createProxy)(String.raw`/Users/fuuentes/workspace/qroo_final/workspace/frontend/src/components/OwnerMenuItemsClient.tsx#default`);var n=r(2293);async function i(){let[e,t]=await Promise.all([(0,n.M)("/menu-items"),(0,n.M)("/menu-categories")]);return(0,s.jsxs)("div",{className:"mx-auto max-w-4xl px-6 py-8",children:[(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Menu Items"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Cafe + time items available from desk QR."})]}),s.jsx(a,{items:e,categories:t})]})}},2293:(e,t,r)=>{"use strict";r.d(t,{M:()=>a});var s=r(1615);async function a(e){let t=process.env.NEXT_PUBLIC_API_URL||"http://localhost:3001",r=(0,s.cookies)(),a=r.get("access_token")?.value,n=await fetch(`${t}${e}`,{cache:"no-store",headers:a?{cookie:`access_token=${a}`}:{}});if(!n.ok)throw Error(await n.text()||`Request failed: ${n.status}`);return n.json()}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[380,301,569],()=>r(5761));module.exports=s})();